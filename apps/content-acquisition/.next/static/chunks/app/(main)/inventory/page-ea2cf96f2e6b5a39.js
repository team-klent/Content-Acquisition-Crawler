(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{829:()=>{},1672:(e,a,t)=>{"use strict";t.d(a,{$:()=>i});var r=t(8861),s=t(2495),n=t(3839),l=t(3705),o=t(4727);let c=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-[#2B76E5] text-white font-[16.16px] shadow hover:bg-[#2B76E5]/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),i=l.forwardRef((e,a)=>{let{className:t,variant:n,size:l,asChild:i=!1,...d}=e,m=i?s.DX:"button";return(0,r.jsx)(m,{className:(0,o.cn)(c({variant:n,size:l,className:t})),ref:a,...d})});i.displayName="Button"},2130:()=>{},2482:(e,a,t)=>{"use strict";t.d(a,{default:()=>b});var r=t(8861),s=t(1672),n=t(5210),l=t(6468),o=t(2614),c=t(4283);function i(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;try{let t=(0,o.e)("/api/pdf-proxy"),r=Date.now(),s=Math.floor(1e6*Math.random()),n=new URLSearchParams;n.append("url",e),a%2==0?n.append("_cb","".concat(r,"_").concat(s)):(n.append("_t",r.toString()),n.append("_r",s.toString(36)));let l=["standard","web","cors","stream","xhr","direct"],c=l[a%l.length];switch(n.append("_mode",c),a%4){case 0:n.append("_xhr","true"),n.append("_accept","application/pdf");break;case 1:n.append("_agent","webapp"),n.append("_format","blob");break;case 2:n.append("_nav","direct"),n.append("_stream","true");break;case 3:n.append("_fmt","raw"),n.append("_inline","true")}n.append("_origin",window.location.hostname);let i=Array.from(n.entries());for(let e=i.length-1;e>0;e--){let a=Math.floor(Math.random()*(e+1));[i[e],i[a]]=[i[a],i[e]]}let d=i.map(e=>{let[a,t]=e;return"".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(t))}).join("&");return"".concat(t,"?").concat(d)}catch(t){let a=(0,o.e)("/api/pdf-proxy");return"".concat(a,"?url=").concat(encodeURIComponent(e),"&_cb=").concat(Date.now())}}var d=t(9053);t(8863);var m=t(6896);t(9021);var h=t(5),u=t(8830),x=t(8919),f=t(3705),p=t(5455);function N(e){let{pdfUrl:a,filename:t}=e,[n,l]=(0,f.useState)(Math.random()),[o,d]=(0,f.useState)(!0),[m,h]=(0,f.useState)(null),[x,N]=(0,f.useState)(!1);(0,f.useEffect)(()=>{d(!0),h(null),l(Math.random())},[a]);let b=i(a),j=(0,f.useRef)(null);return(0,f.useEffect)(()=>{let e=()=>{setTimeout(()=>{d(!1),N(!0)},0)},a=()=>{},t=j.current;if(t){t.addEventListener("load",e),t.addEventListener("error",a);let r=setTimeout(()=>{d(!1)},c.B8.LOADING_TIMEOUT);return()=>{t.removeEventListener("load",e),t.removeEventListener("error",a),clearTimeout(r)}}},[b]),(0,r.jsxs)("div",{className:"h-full flex flex-col relative",style:{minHeight:c.B8.PDF_VIEWER_MIN_HEIGHT},children:[o&&(0,r.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-80 flex items-center justify-center z-10",children:(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-700"}),(0,r.jsx)("p",{className:"mt-2",children:"Loading PDF..."})]})}),x&&!o&&!m&&(0,r.jsxs)("div",{className:c.$_.SUCCESS_INDICATOR,children:[(0,r.jsx)(p.A,{className:"w-4 h-4 mr-1"}),(0,r.jsx)("span",{className:"text-xs font-medium",children:"PDF Loaded Successfully"})]}),m&&(0,r.jsx)("div",{className:c.$_.OVERLAY,children:(0,r.jsx)("div",{className:c.$_.CONTAINER.replace("mb-4","max-w-lg"),children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h3",{className:c.$_.TITLE,children:"Failed to load PDF"}),(0,r.jsx)("p",{className:c.$_.MESSAGE.replace("mb-2","mb-4"),children:m}),(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"You can try the following options:"}),(0,r.jsxs)("div",{className:"flex flex-col space-y-2 sm:flex-row sm:space-y-0 sm:space-x-2",children:[(0,r.jsx)(s.$,{variant:"outline",onClick:()=>{d(!0),h(null),l(Math.random())},children:"Try Again"}),(0,r.jsxs)(s.$,{variant:"outline",onClick:()=>window.open(a,"_blank"),children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Download PDF"]})]})]})})}),(0,r.jsxs)("div",{className:"pdf-container",style:{height:"calc(100% - 20px)",minHeight:c.B8.PDF_VIEWER_MIN_HEIGHT},children:[(0,r.jsx)("div",{className:"h-full",children:(0,r.jsx)("object",{ref:j,data:b,type:"application/pdf",width:"100%",height:c.B8.PDF_VIEWER_MIN_HEIGHT,className:"border-2 border-gray-200",children:(0,r.jsxs)("p",{children:["Your browser does not support PDF embedding. ",(0,r.jsx)("a",{href:b,target:"_blank",rel:"noreferrer",children:"Click here to download the PDF"})]})})}),(0,r.jsx)("iframe",{style:{height:"100%",minHeight:c.B8.PDF_VIEWER_MIN_HEIGHT,display:"none",backgroundColor:"#f0f0f0"},className:"w-full border-2 border-gray-200",src:b,title:"PDF Viewer - ".concat(t),onLoad:e=>{setTimeout(()=>{d(!1),N(!0)},0)},onError:e=>{setTimeout(()=>{h("Failed to load the PDF. Using object tag as fallback.")},0)},sandbox:"allow-scripts allow-same-origin allow-forms"},n)]})]})}function b(){let e=(0,x.useSearchParams)(),[a,t]=(0,f.useState)(null),[p,b]=(0,f.useState)(!0),[j,g]=(0,f.useState)(null),[v,w]=(0,f.useState)(!1),[_,E]=(0,f.useState)(!1),y=(0,m.defaultLayoutPlugin)();return((0,f.useEffect)(()=>{(async()=>{try{b(!0),g(null);let a=e.get("project_id"),r=e.get("job_id"),s=e.get("file_id"),n=e.get("task_id");if(!a||!r||!s||!n){g("Missing required URL parameters"),b(!1);return}let l=(0,o.e)("/api/inventory"),c="".concat(l,"?project_id=").concat(a,"&job_id=").concat(r,"&file_id=").concat(s,"&task_id=").concat(n),i=await fetch(c);if(!i.ok){let e=await i.text().catch(()=>"");if(404===i.status)throw Error("Resource not found (404). The API endpoint or requested file might not exist. Check the URL parameters and API route.");if(405===i.status)throw Error("Method Not Allowed (405). The API doesn't support the request method being used. ".concat(e));if(401===i.status)throw Error("Authentication Error (401). API token is missing or invalid. Please check your API_TOKEN environment variable. ".concat(e));else throw Error("API Error: ".concat(i.status,". ").concat(e))}let d=await i.json();if(!d.status||d.error)throw Error(d.error||"Unknown API error");let m=d.file;t(m)}catch(e){g(e instanceof Error?e.message:"Unknown error occurred")}finally{b(!1)}})()},[e]),p)?(0,r.jsx)("div",{className:"flex justify-center items-center min-h-[400px]",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-700"})}):j?(0,r.jsx)("div",{className:c.$_.CONTAINER,children:(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("h3",{className:c.$_.TITLE,children:"Error Loading File"}),(0,r.jsx)("p",{className:c.$_.MESSAGE,children:j})]})}):a?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"flex items-center mb-4",children:(0,r.jsx)("h2",{className:"ml-4 text-2xl font-medium",children:a.file_name})}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"col-span-3 h-[80vh] relative ",style:{minHeight:c.B8.PDF_VIEWER_MIN_HEIGHT},children:[_?(0,r.jsx)(N,{pdfUrl:a.download_url,filename:a.file_name}):(0,r.jsx)(d.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:(0,r.jsx)(d.Viewer,{fileUrl:i(a.download_url),defaultScale:d.SpecialZoomLevel.PageFit,withCredentials:!1,plugins:[y],renderError:e=>(w(!0),(0,r.jsxs)("div",{className:"p-5 text-center",children:[(0,r.jsx)("p",{className:"text-red-500 font-semibold mb-2",children:"Failed to load the PDF document"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.message||"Unknown PDF loading error"}),(0,r.jsxs)("div",{className:"flex justify-center gap-3 mt-6",children:[(0,r.jsxs)(s.$,{variant:"outline",onClick:()=>E(!0),children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Try Direct Viewer"]}),(0,r.jsxs)(s.$,{variant:"outline",onClick:()=>window.open(a.download_url,"_blank"),children:[(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"})," Download PDF"]})]})]}))})}),v&&!_&&(0,r.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,r.jsxs)(s.$,{variant:"secondary",size:"sm",onClick:()=>E(!0),children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Try Direct Viewer"]})}),_&&(0,r.jsx)("div",{className:"absolute bottom-4 right-4",children:(0,r.jsxs)(s.$,{variant:"secondary",size:"sm",onClick:()=>E(!1),children:[(0,r.jsx)(h.A,{className:"mr-2 h-4 w-4"})," Try PDF.js Viewer"]})})]}),(0,r.jsx)("div",{className:"col-span-1",children:(0,r.jsxs)(n.Zp,{children:[(0,r.jsxs)(n.aR,{children:[(0,r.jsx)(n.ZB,{className:"flex items-center gap-2  font-medium",children:"Basic Information"}),(0,r.jsx)(n.BT,{children:"Details about this document"})]}),(0,r.jsxs)(n.Wu,{className:"space-y-4 flex flex-col justify-between",children:[(0,r.jsx)("div",{className:"space-y-6",children:(0,r.jsx)("div",{children:(0,r.jsx)("div",{className:"border rounded-md overflow-hidden",children:(0,r.jsx)("table",{className:"w-full overflow-hidden",children:(0,r.jsxs)(l.BF,{children:[(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"File Name:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:a.file_name})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Project:"}),(0,r.jsxs)(l.nA,{className:c.FF.CONTENT,children:[a.project_code," ",a.project_name&&"(".concat(a.project_name,")")]})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Job:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:a.job_name})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Batch:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:a.batch_name})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Task:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:a.task_name})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Created:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:new Date(a.created_at).toLocaleString()})]}),(0,r.jsxs)(l.Hj,{className:"border-b",children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"Updated:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:new Date(a.updated_at).toLocaleString()})]}),(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:c.FF.HEADER,children:"File Status:"}),(0,r.jsx)(l.nA,{className:c.FF.CONTENT,children:a.current_file_status||"Unknown"})]})]})})})})}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsxs)(s.$,{variant:"ghost",className:"relative cursor-pointer shadow-md ring-1 ring-gray-200 hover:bg-gray-100 w-full",onClick:()=>window.open(a.download_url,"_blank"),children:[(0,r.jsx)(u.A,{className:"mr-2"})," Download PDF"]})})]})]})})]})]}):(0,r.jsx)("div",{className:"text-center py-10",children:(0,r.jsx)("p",{className:"text-gray-500",children:"No file data available"})})}},2614:(e,a,t)=>{"use strict";function r(e){let a=window.location.pathname.startsWith("/app1")?"/app1":"",t=e.startsWith("/")?e:"/".concat(e);return"".concat(a).concat(t)}t.d(a,{e:()=>r})},4283:(e,a,t)=>{"use strict";t.d(a,{$_:()=>o,B8:()=>n,FF:()=>s,vP:()=>l,yJ:()=>r});let r={M1:"V1",M2:"V2"},s={HEADER:"px-4 py-2 bg-gray-100 font-medium text-sm",CONTENT:"px-4 py-2 text-sm break-all pr-2",CONTENT_NO_BREAK:"px-4 py-2 text-sm"},n={PDF_VIEWER_MIN_HEIGHT:"600px",LOADING_TIMEOUT:2500},l={UNIQUE_ID_PREFIX:"file-uid-",DEFAULT_FILE_PATH:"-"},o={CONTAINER:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",TITLE:"text-lg font-medium text-red-800 mb-2",MESSAGE:"text-sm text-red-700 mb-2",SUCCESS_INDICATOR:"absolute top-2 right-2 bg-green-100 text-green-800 px-3 py-1 rounded-full flex items-center z-10 shadow-sm",OVERLAY:"absolute inset-0 bg-white bg-opacity-95 flex items-center justify-center z-10 p-5"}},4727:(e,a,t)=>{"use strict";t.d(a,{O:()=>o,cn:()=>l});var r=t(9975),s=t(2171),n=t(4283);function l(){for(var e=arguments.length,a=Array(e),t=0;t<e;t++)a[t]=arguments[t];return(0,s.QP)((0,r.$)(a))}function o(e){return"".concat(n.vP.UNIQUE_ID_PREFIX).concat(e,"-").concat(Date.now())}},5062:()=>{},5210:(e,a,t)=>{"use strict";t.d(a,{BT:()=>c,Wu:()=>i,ZB:()=>o,Zp:()=>n,aR:()=>l});var r=t(8861);t(3705);var s=t(4727);function n(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...t})}function l(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...t})}function o(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",a),...t})}function c(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",a),...t})}function i(e){let{className:a,...t}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",a),...t})}},6468:(e,a,t)=>{"use strict";t.d(a,{A0:()=>o,BF:()=>c,Hj:()=>i,XI:()=>l,nA:()=>m,nd:()=>d});var r=t(8861),s=t(3705),n=t(4727);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:a,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});l.displayName="Table";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("thead",{ref:a,className:(0,n.cn)("[&_tr]:border-b",t),...s})});o.displayName="TableHeader";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tbody",{ref:a,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});c.displayName="TableBody",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tfoot",{ref:a,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("tr",{ref:a,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});i.displayName="TableRow";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("th",{ref:a,className:(0,n.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})});d.displayName="TableHead";let m=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("td",{ref:a,className:(0,n.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",t),...s})});m.displayName="TableCell",s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,r.jsx)("caption",{ref:a,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},7089:()=>{},8054:(e,a,t)=>{Promise.resolve().then(t.bind(t,2482))},8211:()=>{}},e=>{var a=a=>e(e.s=a);e.O(0,[883,609,115,111,780,806,358],()=>a(8054)),_N_E=e.O()}]);