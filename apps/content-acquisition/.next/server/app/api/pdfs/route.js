(()=>{var e={};e.id=939,e.ids=[939],e.modules={408:()=>{},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1249:(e,t,r)=>{"use strict";r.d(t,{Kv:()=>n,S8:()=>u});var i=r(7285),s=r(7877);async function a(e){let t=process.env.NEXT_PUBLIC_IA_API_URL,r=`${t}/api/register-job-batch-file`;try{e.file_path||(e.file_path=i.vP.DEFAULT_FILE_PATH),e.file_unique_identifier||(e.file_unique_identifier=(0,s.O)(e.file_name));let t={...e,project_id:e.project_id||"",workflow_id:e.workflow_id||""},a=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${process.env.API_TOKEN}`},body:JSON.stringify(t)});if(!a.ok){let e=a.headers.get("content-type"),t="";try{if(e&&e.includes("application/json")){let e=await a.json();t=JSON.stringify(e)}else t=await a.text()}catch(e){t="Could not parse error response"}throw Error(`Failed to register job batch file: ${a.status} ${a.statusText} - ${t}`)}let n=a.headers.get("content-type");if(!n||!n.includes("application/json")){let e=await a.text();throw Error(`Expected JSON response but received: ${e.substring(0,100)}...`)}return await a.json()}catch(e){throw e}}async function n(e,t,r){try{let i,s=await a(e);if("string"!=typeof s.file_output_path)throw Error("file_output_path is not a valid string");let n=await o(t,s.file_output_upload_url);if(n.success&&s.file_id){let t=r?.previousFileStatus||"I",a=r?.fileStatus||"C";try{i=await u({project_code:e.project_code,task_uid:e.first_task_uid,file_id:s.file_id,previous_file_status:t,file_status:a})}catch{}}return{registration:s,upload:n,statusUpdate:i}}catch(e){throw e}}async function o(e,t){try{let i=await Promise.resolve().then(r.t.bind(r,9021,23));if(!i.existsSync(e))throw Error(`File not found at path: ${e}`);let s=i.readFileSync(e),a=await fetch(t,{method:"PUT",body:s});if(!a.ok)throw Error(`Failed to upload file: ${a.status} ${a.statusText}`);return{success:!0,message:"File uploaded successfully"}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error occurred during file upload"}}}async function u(e){let t=process.env.NEXT_PUBLIC_IA_API_URL,r=`${t}/api/update-file-status`;try{let t=["project_code","task_uid","file_id","previous_file_status","file_status"].filter(t=>!e[t]||"string"==typeof e[t]&&""===e[t].trim());if(t.length>0)throw Error(`Missing required fields: ${t.join(", ")}`);let i=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${process.env.API_TOKEN}`},body:JSON.stringify(e)});if(!i.ok){let e=i.headers.get("content-type"),t="";try{if(e&&e.includes("application/json")){let e=await i.json();t=JSON.stringify(e)}else t=await i.text()}catch(e){t=`${e} Could not parse error response`}throw Error(`Failed to update file status: ${i.status} ${i.statusText} - ${t}`)}return await i.json()}catch(e){throw e}}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7032:()=>{},7285:(e,t,r)=>{"use strict";r.d(t,{vP:()=>s,yJ:()=>i});let i={M1:"V1",M2:"V2"},s={UNIQUE_ID_PREFIX:"file-uid-",DEFAULT_FILE_PATH:"-"}},7739:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>g,routeModule:()=>y,serverHooks:()=>m,workAsyncStorage:()=>j,workUnitAsyncStorage:()=>x});var i={};r.r(i),r.d(i,{GET:()=>h,POST:()=>w});var s=r(8106),a=r(8819),n=r(2050),o=r(1249),u=r(9021),p=r.n(u),c=r(3873),l=r.n(c);async function d(e=l().join(process.cwd(),"public","pdfs")){try{if(!p().existsSync(e))return[];return p().readdirSync(e).filter(e=>".pdf"===l().extname(e).toLowerCase()).map((t,r)=>{let i,s=l().join(e,t),a=p().statSync(s),n=a.size;i=n<1024?n+" bytes":n<1048576?Math.round(n/1024)+" KB":(n/1048576).toFixed(1)+" MB";let o=t.replace(".pdf","").split(/[-_]/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return{id:(r+1).toString(),title:o,filename:t,path:`/pdfs/${t}`,size:i,type:"pdf",createdAt:new Date(a.birthtime),updatedAt:new Date(a.mtime),isActive:!0}})}catch{return[]}}var f=r(7285),_=r(4235);async function h(){try{let e=await d();return _.NextResponse.json({pdfs:e})}catch{return _.NextResponse.json({error:"Failed to retrieve PDF documents"},{status:500})}}let w=async e=>{try{let t=await e.json(),r=["project_code","workflow_code","first_task_uid","file_name"].filter(e=>!t[e]||"string"==typeof t[e]&&""===t[e].trim());if(r.length>0)return _.NextResponse.json({error:`Missing required fields: ${r.join(", ")}`},{status:400});t.file_unique_identifier&&""!==t.file_unique_identifier.trim()||(t.file_unique_identifier=`file-uid-${t.file_name}-${Date.now()}`),t.file_path&&""!==t.file_path.trim()||(t.file_path="-"),t.meta_data||(t.meta_data=f.yJ);let i=function(e){let t=e.startsWith("/")?e.slice(1):e;return c.join(process.cwd(),"public",t)}(t.file_path);if(!u.existsSync(i))return _.NextResponse.json({error:`File not found at path: ${i}, please check if this file exists on this path`},{status:404});let s={...t,file_path:i},a=s.file_path;return await (0,o.Kv)(s,a),_.NextResponse.json(s,{status:200})}catch{return _.NextResponse.json({error:"Failed to retrieve PDF documents"},{status:500})}},y=new s.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/pdfs/route",pathname:"/api/pdfs",filename:"route",bundlePath:"app/api/pdfs/route"},resolvedPagePath:"/Users/aritchellecal/Documents/personal/Content-Acquisition-Crawler/apps/content-acquisition/app/api/pdfs/route.ts",nextConfigOutput:"",userland:i}),{workAsyncStorage:j,workUnitAsyncStorage:x,serverHooks:m}=y;function g(){return(0,n.patchFetch)({workAsyncStorage:j,workUnitAsyncStorage:x})}},7877:(e,t,r)=>{"use strict";r.d(t,{O:()=>o,cn:()=>n});var i=r(6413),s=r(4465),a=r(7285);function n(...e){return(0,s.QP)((0,i.$)(e))}function o(e){return`${a.vP.UNIQUE_ID_PREFIX}${e}-${Date.now()}`}},9021:e=>{"use strict";e.exports=require("fs")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),i=t.X(0,[191,85,744],()=>r(7739));module.exports=i})();