(()=>{var e={};e.id=363,e.ids=[363],e.modules={113:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>_,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>d});var s={};r.r(s),r.d(s,{POST:()=>c});var i=r(9837),a=r(6890),o=r(5513),n=r(3279),u=r(1516);async function c(e){try{let t=await e.json(),r=["project_code","task_uid","file_id","previous_file_status","file_status"].filter(e=>!t[e]||"string"==typeof t[e]&&""===t[e].trim());if(r.length>0)return u.NextResponse.json({error:`Missing required fields: ${r.join(", ")}`},{status:400});let s=await (0,n.S8)(t);return u.NextResponse.json(s)}catch(e){return u.NextResponse.json({error:e instanceof Error?e.message:"Unknown error occurred"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/update-file-status/route",pathname:"/api/update-file-status",filename:"route",bundlePath:"app/api/update-file-status/route"},resolvedPagePath:"/Users/aritchellecal/Documents/personal/Content-Acquisition-Crawler/apps/content-acquisition/app/api/update-file-status/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:d,serverHooks:f}=p;function _(){return(0,o.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:d})}},846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},975:(e,t,r)=>{"use strict";r.d(t,{vP:()=>i,yJ:()=>s});let s={M1:"V1",M2:"V2"},i={UNIQUE_ID_PREFIX:"file-uid-",DEFAULT_FILE_PATH:"-"}},2275:(e,t,r)=>{"use strict";r.d(t,{O:()=>n,cn:()=>o});var s=r(6377),i=r(7273),a=r(975);function o(...e){return(0,i.QP)((0,s.$)(e))}function n(e){return`${a.vP.UNIQUE_ID_PREFIX}${e}-${Date.now()}`}},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3279:(e,t,r)=>{"use strict";r.d(t,{Kv:()=>o,S8:()=>u});var s=r(975),i=r(2275);async function a(e){let t=process.env.NEXT_PUBLIC_IA_API_URL,r=`${t}/api/register-job-batch-file`;try{e.file_path||(e.file_path=s.vP.DEFAULT_FILE_PATH),e.file_unique_identifier||(e.file_unique_identifier=(0,i.O)(e.file_name));let t={...e,project_id:e.project_id||"",workflow_id:e.workflow_id||""},a=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${process.env.API_TOKEN}`},body:JSON.stringify(t)});if(!a.ok){let e=a.headers.get("content-type"),t="";try{if(e&&e.includes("application/json")){let e=await a.json();t=JSON.stringify(e)}else t=await a.text()}catch(e){t="Could not parse error response"}throw Error(`Failed to register job batch file: ${a.status} ${a.statusText} - ${t}`)}let o=a.headers.get("content-type");if(!o||!o.includes("application/json")){let e=await a.text();throw Error(`Expected JSON response but received: ${e.substring(0,100)}...`)}return await a.json()}catch(e){throw e}}async function o(e,t,r){try{let s,i=await a(e);if("string"!=typeof i.file_output_path)throw Error("file_output_path is not a valid string");let o=await n(t,i.file_output_upload_url);if(o.success&&i.file_id){let t=r?.previousFileStatus||"I",a=r?.fileStatus||"C";try{s=await u({project_code:e.project_code,task_uid:e.first_task_uid,file_id:i.file_id,previous_file_status:t,file_status:a})}catch{}}return{registration:i,upload:o,statusUpdate:s}}catch(e){throw e}}async function n(e,t){try{let s=await Promise.resolve().then(r.t.bind(r,9021,23));if(!s.existsSync(e))throw Error(`File not found at path: ${e}`);let i=s.readFileSync(e),a=await fetch(t,{method:"PUT",body:i});if(!a.ok)throw Error(`Failed to upload file: ${a.status} ${a.statusText}`);return{success:!0,message:"File uploaded successfully"}}catch(e){return{success:!1,message:e instanceof Error?e.message:"Unknown error occurred during file upload"}}}async function u(e){let t=process.env.NEXT_PUBLIC_IA_API_URL,r=`${t}/api/update-file-status`;try{let t=["project_code","task_uid","file_id","previous_file_status","file_status"].filter(t=>!e[t]||"string"==typeof e[t]&&""===e[t].trim());if(t.length>0)throw Error(`Missing required fields: ${t.join(", ")}`);let s=await fetch(r,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${process.env.API_TOKEN}`},body:JSON.stringify(e)});if(!s.ok){let e=s.headers.get("content-type"),t="";try{if(e&&e.includes("application/json")){let e=await s.json();t=JSON.stringify(e)}else t=await s.text()}catch(e){t=`${e} Could not parse error response`}throw Error(`Failed to update file status: ${s.status} ${s.statusText} - ${t}`)}return await s.json()}catch(e){throw e}}},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},7093:()=>{},7365:()=>{},9021:e=>{"use strict";e.exports=require("fs")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[579,681,74],()=>r(113));module.exports=s})();